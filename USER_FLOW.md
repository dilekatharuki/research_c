# User Flow - Empathetic Conversational Support System

## ðŸŽ¯ Complete User Journey

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SYSTEM STARTUP                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                    Run: .\start_system.ps1
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                           â”‚
                    â–¼                           â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Backend API     â”‚      â”‚  Frontend UI     â”‚
         â”‚  Port: 8000      â”‚      â”‚  Port: 8501      â”‚
         â”‚  (FastAPI)       â”‚      â”‚  (Streamlit)     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER OPENS BROWSER                                â”‚
â”‚              http://localhost:8501                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“‹ Flow 1: Behavioral Assessment (Optional)

```
User Opens Streamlit UI
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sidebar Navigation  â”‚
â”‚                     â”‚
â”‚ ðŸ“‹ Behavioral       â”‚â—„â”€â”€â”€ User clicks to expand
â”‚    Assessment       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Questionnaire Interface                â”‚
â”‚                                         â”‚
â”‚  Q1: Work Environment (dropdown)        â”‚
â”‚      â˜ High-pressure deadlines          â”‚
â”‚      â˜ Collaborative team               â”‚
â”‚      â˜ Independent focus                â”‚
â”‚      â˜‘ Balanced routine                 â”‚
â”‚                                         â”‚
â”‚  Q2: Stress Management (slider: 1-10)  â”‚
â”‚      [â”â”â”â”â”â”â—â”â”â”] (7)                   â”‚
â”‚                                         â”‚
â”‚  Q3: Self-Care Frequency (dropdown)    â”‚
â”‚      â˜‘ A few times a week               â”‚
â”‚                                         â”‚
â”‚  Q4: Support Interest (dropdown)       â”‚
â”‚      â˜‘ Long-term strategies             â”‚
â”‚                                         â”‚
â”‚  Q5: Energy Level (slider: 1-10)      â”‚
â”‚      [â”â”â”â”â”â—â”â”â”â”] (6)                   â”‚
â”‚                                         â”‚
â”‚     [ðŸ“Š Submit Assessment]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    User clicks Submit
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend â†’ Backend API Call            â”‚
â”‚  POST /questionnaire/submit             â”‚
â”‚  {                                      â”‚
â”‚    "session_id": "uuid",                â”‚
â”‚    "answers": {                         â”‚
â”‚      "work_environment": "Balanced..",  â”‚
â”‚      "stress_management": 7,            â”‚
â”‚      "selfcare_frequency": "A few..",   â”‚
â”‚      "support_interest": "Long-term..", â”‚
â”‚      "energy_level": 6                  â”‚
â”‚    }                                    â”‚
â”‚  }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Processes                      â”‚
â”‚  1. Calculate individual scores         â”‚
â”‚  2. Compute total score (23/31)        â”‚
â”‚  3. Determine category (Good)          â”‚
â”‚  4. Generate interpretation            â”‚
â”‚  5. Save to files:                     â”‚
â”‚     - questionnaire_results/           â”‚
â”‚       {session_id}_{timestamp}.json    â”‚
â”‚       {session_id}_{timestamp}.csv     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response Displayed                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœ… Assessment completed!          â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ Your Behavioral Score             â”‚ â”‚
â”‚  â”‚       23.0/31                     â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ Category: Good Well-being         â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ You're managing well overall...   â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ ðŸ“„ Results saved to:              â”‚ â”‚
â”‚  â”‚ questionnaire_results/...json     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸŽ­ Flow 2: Persona Selection & Chat

```
User in Main Interface
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Sidebar: Choose Your Support Persona   â”‚
â”‚                                         â”‚
â”‚  ðŸ‘¥ Friend                              â”‚
â”‚     [Select Friend]                     â”‚â—„â”€â”€â”€ User clicks
â”‚                                         â”‚
â”‚  ðŸ§‘â€âš•ï¸ Counselor                         â”‚
â”‚     [Select Counselor]                  â”‚
â”‚                                         â”‚
â”‚  ðŸ‘¨â€âš•ï¸ Medical Officer                   â”‚
â”‚     [Select Medical Officer]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    User selects Persona
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Session Created                        â”‚
â”‚  POST /session/create                   â”‚
â”‚  Response: { "session_id": "uuid" }     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Main Chat Interface                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ðŸ’™ ManÅ                           â”‚ â”‚
â”‚  â”‚ Empathetic Mental Health Support  â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ Currently chatting with:          â”‚ â”‚
â”‚  â”‚ ðŸ‘¥ Friend                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  [Chat History Area - Empty]            â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Type your message...              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚    [ðŸ“¤ Send] [ðŸ—‘ï¸ Clear]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ’¬ Flow 3: Chat Interaction

```
User Types Message
         â”‚
         â–¼
"I'm feeling really stressed about work deadlines"
         â”‚
         â–¼
    User clicks Send
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Processing                    â”‚
â”‚  1. Get current persona (Friend)        â”‚
â”‚  2. Get session_id                      â”‚
â”‚  3. Prepare API request                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Call: POST /chat                   â”‚
â”‚  {                                      â”‚
â”‚    "session_id": "uuid",                â”‚
â”‚    "message": "I'm feeling really..",   â”‚
â”‚    "persona": "friend"                  â”‚
â”‚  }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Processing Flow                â”‚
â”‚                                         â”‚
â”‚  1. Validate Session âœ“                  â”‚
â”‚  2. Validate Persona âœ“                  â”‚
â”‚  3. Detect PII (none found)             â”‚
â”‚  4. Preprocess Text                     â”‚
â”‚  5. BERT Intent Classification          â”‚
â”‚     â†’ Intent: "work_stress"             â”‚
â”‚     â†’ Confidence: 92%                   â”‚
â”‚  6. Crisis Detection (none)             â”‚
â”‚  7. Emotion Analysis                    â”‚
â”‚     â†’ Detected: stress, worry           â”‚
â”‚  8. Context Building                    â”‚
â”‚     â†’ Last 5 messages                   â”‚
â”‚     â†’ Detected emotions                 â”‚
â”‚  9. Persona Response Generation         â”‚
â”‚     â†’ Friend generates empathetic reply â”‚
â”‚  10. Add to Session History             â”‚
â”‚  11. AUTO-SAVE Chat History             â”‚
â”‚      â†’ chat_history/{session_id}.json   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response Returned                      â”‚
â”‚  {                                      â”‚
â”‚    "session_id": "uuid",                â”‚
â”‚    "user_message": "I'm feeling..",     â”‚
â”‚    "bot_response": "That sounds..",     â”‚
â”‚    "persona": "friend",                 â”‚
â”‚    "intent": "work_stress",             â”‚
â”‚    "confidence": 0.92,                  â”‚
â”‚    "crisis_detected": false             â”‚
â”‚  }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI Updated                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ You:                              â”‚ â”‚
â”‚  â”‚ I'm feeling really stressed       â”‚ â”‚
â”‚  â”‚ about work deadlines              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ðŸ‘¥ Friend:                        â”‚ â”‚
â”‚  â”‚ That sounds really tough. I'm     â”‚ â”‚
â”‚  â”‚ here for you. What's been         â”‚ â”‚
â”‚  â”‚ weighing on you the most? ðŸ’™      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  [Chat continues...]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”„ Flow 4: Switching Personas

```
User chatting with Friend
         â”‚
         â–¼
User clicks Sidebar â†’ "Select Counselor"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Persona Changed                        â”‚
â”‚  st.session_state.current_persona       â”‚
â”‚  = 'counselor'                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI Updates                             â”‚
â”‚  Currently chatting with:               â”‚
â”‚  ðŸ§‘â€âš•ï¸ Counselor                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
User sends next message
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /chat with persona: "counselor"   â”‚
â”‚  â†’ Counselor generates response         â”‚
â”‚  â†’ May include CBT techniques           â”‚
â”‚  â†’ May recommend video resources        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸš¨ Flow 5: Crisis Detection

```
User Types Crisis Message
         â”‚
         â–¼
"I don't want to live anymore"
         â”‚
         â–¼
    Message sent to backend
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Crisis Detection               â”‚
â”‚  persona.detect_crisis(message)         â”‚
â”‚  â†’ Matches crisis keywords              â”‚
â”‚  â†’ Returns: True                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Crisis Response Triggered              â”‚
â”‚  1. Generate empathetic response        â”‚
â”‚  2. Provide crisis resources            â”‚
â”‚  3. Set crisis_detected = True          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI Displays Crisis Alert               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš ï¸ Crisis Detected                â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ If you're experiencing thoughts   â”‚ â”‚
â”‚  â”‚ of self-harm, please contact:     â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚ â€¢ National Suicide Prevention     â”‚ â”‚
â”‚  â”‚   Lifeline: 988                   â”‚ â”‚
â”‚  â”‚ â€¢ Crisis Text Line:               â”‚ â”‚
â”‚  â”‚   Text HELLO to 741741            â”‚ â”‚
â”‚  â”‚ â€¢ Emergency Services: 911         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š Flow 6: Data Persistence

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AUTO-SAVE: Chat History                â”‚
â”‚  Triggered: After every message         â”‚
â”‚                                         â”‚
â”‚  Location: chat_history/                â”‚
â”‚  File: {session_id}.json                â”‚
â”‚                                         â”‚
â”‚  Contains:                              â”‚
â”‚  â€¢ session_id                           â”‚
â”‚  â€¢ messages (user + bot)                â”‚
â”‚  â€¢ metadata (persona, intent, conf)     â”‚
â”‚  â€¢ created_at timestamp                 â”‚
â”‚  â€¢ last_updated timestamp               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AUTO-SAVE: Questionnaire Results       â”‚
â”‚  Triggered: On questionnaire submit     â”‚
â”‚                                         â”‚
â”‚  Location: questionnaire_results/       â”‚
â”‚  Files:                                 â”‚
â”‚   â€¢ {session_id}_{timestamp}.json       â”‚
â”‚   â€¢ {session_id}_{timestamp}.csv        â”‚
â”‚                                         â”‚
â”‚  Contains:                              â”‚
â”‚  â€¢ Raw answers                          â”‚
â”‚  â€¢ Individual scores                    â”‚
â”‚  â€¢ Total score                          â”‚
â”‚  â€¢ Category                             â”‚
â”‚  â€¢ Interpretation                       â”‚
â”‚  â€¢ Timestamp                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”Œ Flow 7: API Integration (External Systems)

```
External System/Developer
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Model Prediction API                   â”‚
â”‚                                         â”‚
â”‚  1. Single Prediction                   â”‚
â”‚     POST /model/predict                 â”‚
â”‚     â†’ Get intent + confidence           â”‚
â”‚                                         â”‚
â”‚  2. Batch Prediction                    â”‚
â”‚     POST /model/predict/batch           â”‚
â”‚     â†’ Get multiple predictions          â”‚
â”‚                                         â”‚
â”‚  3. Model Info                          â”‚
â”‚     GET /model/info                     â”‚
â”‚     â†’ Get model metadata                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Response with predictions
         â”‚
         â–¼
External system processes results
```

---

## ðŸ” Flow 8: History Retrieval

```
Developer/Admin
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chat History API                       â”‚
â”‚                                         â”‚
â”‚  1. Get Specific Session                â”‚
â”‚     GET /history/{session_id}           â”‚
â”‚     â†’ Returns full conversation         â”‚
â”‚                                         â”‚
â”‚  2. List All Histories                  â”‚
â”‚     GET /history                        â”‚
â”‚     â†’ Returns list of all sessions      â”‚
â”‚                                         â”‚
â”‚  3. Manual Save                         â”‚
â”‚     POST /history/{session_id}/save     â”‚
â”‚     â†’ Manually trigger save             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸŽ¯ Complete User Journey Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ START SYSTEM â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OPEN BROWSER (8501)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                         â”‚
       â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (Optional)   â”‚      â”‚ Select Persona     â”‚
â”‚ Complete     â”‚----->â”‚ â€¢ Friend           â”‚
â”‚ Behavioral   â”‚      â”‚ â€¢ Counselor        â”‚
â”‚ Assessment   â”‚      â”‚ â€¢ Medical Officer  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                       â”‚
       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get Score    â”‚      â”‚ Start Chatting     â”‚
â”‚ & Insights   â”‚      â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ Each Message:      â”‚
                      â”‚ â€¢ Intent detected  â”‚
                      â”‚ â€¢ Response generatedâ”‚
                      â”‚ â€¢ History saved    â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ Crisis Detected?   â”‚
                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚       â”‚
                         Yes       No
                           â”‚       â”‚
                           â–¼       â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Show     â”‚ â”‚ Continue â”‚
                    â”‚ Crisis   â”‚ â”‚ Chat     â”‚
                    â”‚ Resourcesâ”‚ â”‚          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚       â”‚
                           â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                               â”‚
                               â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ All Data Saved:    â”‚
                      â”‚ â€¢ Chat history     â”‚
                      â”‚ â€¢ Questionnaire    â”‚
                      â”‚ â€¢ Session metadata â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“± Key User Touchpoints

### 1. **Entry Point**
- URL: http://localhost:8501
- Automatic session creation on first interaction

### 2. **Optional Assessment**
- Sidebar â†’ Behavioral Assessment
- 5 questions, automated scoring
- Results displayed immediately
- Files saved for analysis

### 3. **Persona Selection**
- Sidebar â†’ Choose persona
- Can switch anytime during conversation
- Each persona has unique response style

### 4. **Chat Interface**
- Main area for conversation
- Real-time message exchange
- Auto-clearing input box
- Emoji support

### 5. **Crisis Support**
- Automatic detection
- Immediate resource display
- Emergency contact information

### 6. **Data Persistence**
- All conversations auto-saved
- Assessment results auto-saved
- Accessible via API for analysis

---

## ðŸ”„ Session Lifecycle

```
1. User Opens App
   â””â”€> Creates new session (UUID)

2. (Optional) Completes Assessment
   â””â”€> Score calculated & saved

3. Selects Persona
   â””â”€> Current persona tracked in session

4. Sends Messages
   â””â”€> Each message:
       â”œâ”€> Processed by BERT
       â”œâ”€> Response generated
       â”œâ”€> History updated
       â””â”€> Auto-saved to file

5. Session Ends (User closes browser)
   â””â”€> Data persists in:
       â”œâ”€> chat_history/{session_id}.json
       â””â”€> questionnaire_results/{session_id}_{timestamp}.json/csv
```

---

## ðŸ“Š Data Flow Architecture

```
User Input
    â”‚
    â–¼
Streamlit Frontend (Port 8501)
    â”‚
    â–¼
FastAPI Backend (Port 8000)
    â”‚
    â”œâ”€> BERT Model (Intent Classification)
    â”œâ”€> Persona Engine (Response Generation)
    â”œâ”€> Privacy Manager (PII Detection)
    â””â”€> Session Manager (State Tracking)
    â”‚
    â–¼
Data Storage
    â”œâ”€> chat_history/ (JSON)
    â”œâ”€> questionnaire_results/ (JSON + CSV)
    â””â”€> In-Memory Session State
```

---

## ðŸŽ“ User Actions Summary

| Action | Trigger | Backend Call | Result |
|--------|---------|--------------|--------|
| Open App | Browser navigate | GET /health | UI loads |
| Complete Assessment | Submit button | POST /questionnaire/submit | Score + files saved |
| Select Persona | Persona button | (Frontend only) | UI updates |
| Send Message | Send button | POST /chat | Response + auto-save |
| Switch Persona | Different button | (Frontend only) | Next message uses new persona |
| View History | (API only) | GET /history/{id} | History returned |

